### Gerenciamento de Dotfiles

- name: Instalar Git
  become: yes
  package:
    name: git
    state: present

- name: Configurar repositório bare para dotfiles
  become: yes
  become_user: cr
  git:
    repo: 'git@github.com:camilasrody/dotfiles.git'
    version: master
    bare: yes
    dest: '~/.dotfiles'
    accept_hostkey: yes
    key_file: '~/.ssh/id_ed25519'

- name: Configurar alias para gerenciar dotfiles
  become: yes
  become_user: cr
  lineinfile:
    path: '~/.bashrc'
    line: "alias dotfiles='/usr/bin/git --git-dir=~/.dotfiles/ --work-tree=~'"
    create: yes

- name: Configurar Git para não mostrar arquivos não rastreados
  become: yes
  become_user: cr
  command: git --git-dir=~/.dotfiles/ --work-tree=~ config --local status.showUntrackedFiles no

- name: Checkout dos dotfiles
  become: yes
  become_user: cr
  command: git --git-dir=~/.dotfiles/ --work-tree=~ checkout
  ignore_errors: yes